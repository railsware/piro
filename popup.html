<!DOCTYPE html>
<html>
  <head>
    <title>PiRo</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link href="stylesheets/reset.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="stylesheets/grids.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="stylesheets/spaces.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="stylesheets/group-headers.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="stylesheets/group-buttons.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="stylesheets/group-forms.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="stylesheets/layout.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="stylesheets/library.css" media="screen" rel="stylesheet" type="text/css" />

    <!-- chosen -->
    <link href="stylesheets/chosen/chosen.css" media="screen" rel="stylesheet" type="text/css" />
    <!-- jquery ui datepicker -->
    <link href="stylesheets/jquery_ui/datepicker.css" media="screen" rel="stylesheet" type="text/css" />
  </head>
<body>
  <div id="mainPage" class="outer page">
    <!-- main screen -->
    <div id="leftPanel" class="unit size1of2">
      <!-- panel -->

      <div id="storiesTabs">
        <div id="ownerStories" class="tabs_content_block">
          <ul class="nav outer">
            <li class="owner tab size1of3"><a id="currentTabLabel" href="#currentTab">Current</a></li>
            <li class="owner tab size1of3"><a id="doneTabLabel" href="#doneTab">Done</a></li>
            <li class="owner tab size1of3"><a id="iceboxTabLabel" href="#iceboxTab">IceBox</a></li>
          </ul>
          <!-- tabs content -->
          <div id="currentTab" class="tabs_content data-holder">
            <ul id="currentStoriesList" class="projects_stories_list">
            </ul>
          </div>
          <div id="doneTab" class="tabs_content data-holder">
            <ul id="doneStoriesList" class="projects_stories_list">
            </ul>
          </div>
          <div id="iceboxTab" class="tabs_content data-holder">
            <ul id="iceboxStoriesList" class="projects_stories_list">
            </ul>
          </div>
        </div>

        <!-- requester tabs content -->
        <div id="requesterStories" class="tabs_content_block">
          <ul class="nav outer">
            <li class="requester tab size1of3"><a id="currentRequesterTabLabel" href="#currentRequesterTab">Current</a></li>
            <li class="requester tab size1of3"><a id="doneRequesterTabLabel" href="#doneRequesterTab">Done</a></li>
            <li class="requester tab size1of3"><a id="iceboxRequesterTabLabel" href="#iceboxRequesterTab">IceBox</a></li>
          </ul>
          <div id="currentRequesterTab" class="tabs_content data-holder">
            <ul id="currentRequesterStoriesList" class="projects_stories_list">
            </ul>
          </div>
          <div id="doneRequesterTab" class="tabs_content data-holder">
            <ul id="doneRequesterStoriesList" class="projects_stories_list">
            </ul>
          </div>
          <div id="iceboxRequesterTab" class="tabs_content data-holder">
            <ul id="iceboxRequesterStoriesList" class="projects_stories_list">
            </ul>
          </div>
        </div>

        <div class="footer">
          <div class="outer">
            <div class="unit size1of2 ptxs">
              <div id="changeAccountBox" class="unit mls">
                <!-- <label class="h4">Account:</label> -->
                 <select id="changeAccount"></select>
              </div>
              <div id="selecterStoriesBox" class="unit-right mrs">
                <span class="switcher">
                  <a class="selecter_stories_type" href="#" data-value="owner">Owner</a>
                  <a class="selecter_stories_type" href="#" data-value="requester">Requester</a>
                </span>
               </div>
            </div> <!-- unit size1of2 -->
            <div class="unit size1of2">
              <div class="footer-sep outer ptxs">
                <div class="unit mls">
                  <a id="settingsLink" href="#" class="button default tiny settings-btn"><span>Settings</span></a>
                </div>
                <div class="unit-right mrs">
                   <span class="h4 neutral powered">Brought to you by <a href="http://railsware.com/?utm_source=piro.railsware.com&utm_medium=cpc&utm_term=rw%2Bproduct&utm_campaign=piro" target="_blank"><img src="images/rw.png" alt="Railsware" /></a></span>
                 </div>
              </div> <!-- empty -->

            </div> <!-- unit size1of2 -->
          </div> <!-- outer -->
        </div> <!-- footer -->

      </div>
    </div>

    <!-- main story info and notifications -->
    <div id="rightPanel" class="unit size1of2">
      <div class="story-header outer">
        <div class="unit size4of5">
          <div class="plm">
            <input id="searchStories" type="search" placeholder="Search stories" />
          </div> <!-- plm -->
        </div> <!-- unit -->
        <div class="unit-right size1of5 txt-right">
          <span id="loaderSpinner"></span>
          <a href="#" class="add-task add_new_story_link" title="Add New Story"><img src="images/add-light.png" alt="Add Story" /></a>
        </div> <!-- unit -->
      </div>
      <div id="infoPanel" class="data-holder empty txt-center"></div>
      <div id="storyInfo" class="data-holder grey-box pam"></div>
      <div id="addStoryView" class="data-holder grey-box pam"></div>
    </div>

  </div>

  <div id="loginPage" class="pal">
    <div class="txt-center mbm">
      <img id="loginLogo" src="images/logo.png" alt="PiRo" />
    </div> <!-- txt-center -->

    <span class="switcher wide mbs">
      <a id="pivotalBaseAuthLink" href="#" class="login_switcher_link active">Login with Email</a>
      <a id="pivotalTokenAuthLink" href="#" class="login_switcher_link">Login with Token</a>
    </span>
    <!-- login -->
    <strong class="error_msg error-text negative"></strong>
    <div id="pivotalBaseAuth">
      <div class="pbs">
        <input id="loginUsername" class="h2" type="text" placeholder="Email" />
      </div> <!-- pbs -->
      <div class="pbs">
        <input id="loginPassword" class="h2" type="password" placeholder="Password" />
      </div> <!-- pbs -->
    </div>
    <div id="pivotalTokenAuth">
      <div class="pbs">
        <input id="loginToken" class="h2" type="text" placeholder="Token" />
      </div> <!-- pbs -->
    </div>
    <div>
      <div class="pvs txt-center">
        <a href="#" id="loginButton" class="button success large">Login</a>
      </div> <!-- pvs -->
    </div>
  </div>

  <!-- templates -->
  <script id="spinner_template" type="text/x-mustache-template">
    {{#is_loading}}
      <img src="images/spinner.gif" alt="{{loading_msg}}" title="{{loading_msg}}" />
    {{/is_loading}}
    {{^is_loading}}
      <a class="update_stories" href="#">
        <img src="images/refresh.gif" alt="{{update_msg}}" title="{{update_msg}}" />
      </a>
    {{/is_loading}}
  </script>

  <script id="project_cell_template" type="text/x-mustache-template">
    <li class="project_{{id}} project_cell{{#view_conditions}}{{#hide_project_cell}} hide-project{{/hide_project_cell}}{{/view_conditions}}" data-project-id="{{id}}">

      <div class="title">
        <span class="toggle_project unit"></span> 
        <span class="dbclick_toggle_project project-title">({{count_of_stories}}) {{name}}</span> 
        <span class="sort_project unit-right" title="Drag to sort projects" data-project-id="{{id}}"></span>
      </div>

      <ul data-project-id="{{id}}" {{#is_requested_by_me}}data-requested="true"{{/is_requested_by_me}} class="list stories">
        {{#stories}}
          <li class="story_info story_{{id}} {{box_class}}-box outer" data-story-id="{{id}}">
            <div class="unit"><span class="{{story_type}}-icon"></span></div>
            <div class="unit-right"><span class="status">{{current_state}}</span></div>
            <div class="story-name">{{name}}</div>
          </li>
        {{/stories}}
      </ul>
    </li>
  </script>

  <script id="story_info_template" type="text/x-mustache-template">

    <div class="outer story-details-header">
      <div class="unit size1of2">
        <div class="outer clippy-holder mbxs">
          <div class="unit pale">ID: <span class="clippy-text neutral">{{id}}</span> </div>
          <div class="clippy-box"><div id="clippyStory{{id}}"></div></div>
        </div>
        <div class="outer clippy-holder">
          <div class="unit pale"><a href="{{url}}" target="_blank">Story link</a> </div>
          <div class="clippy-box"><div id="clippyUrl{{id}}"></div></div>
        </div>
      </div>
      <div class="unit size1of2 txt-right">
        <div class="change_story_box">
          <div class="main options">
          {{#need_estimate}}
            <div class="mbxs">
              <span class="label">Estimate: </span>
              <select class="change_story_estimate" data-story-id="{{id}}" data-project-id="{{project_id}}">
                <option value="-1">Unestimated</option>
                {{#point_scale}}
                  <option value="{{point}}">{{point}} points</option>
                {{/point_scale}}
              </select>
            </div>
          {{/need_estimate}}

          {{^need_estimate}}
            <div class="mbxs">
              <span class="label">Estimate: </span> <div class="value"><span class="status block txt-center">{{estimate_text}}</span></div>
            </div>
          {{/need_estimate}}

          {{^unestimated_feature}}
            <div>
              <span class="label">Status: </span>
              <select class="change_story_state mbxs" data-story-id="{{id}}" data-project-id="{{project_id}}">
                <option value="unstarted">Not Yet Started</option>
                {{#story_type_can_started}}
                  <option value="started">Started</option>
                {{/story_type_can_started}}
                {{#story_type_many_statuses}}
                  <option value="finished">Finished</option>
                  <option value="delivered">Delivered</option>
                {{/story_type_many_statuses}}
                <option value="accepted">Accepted</option>
                {{#story_type_many_statuses}}
                  <option value="rejected">Rejected</option>
                {{/story_type_many_statuses}}
              </select>
            </div>

          {{/unestimated_feature}}

          {{#unestimated_feature}}
            <div>
              <span class="label">Status: </span> <div class="value"><span class="status status block txt-center">{{current_state}}</span></div>
            </div>
          {{/unestimated_feature}}

          </div>
          <div class="loader">
            <img src="images/spinner3.gif" alt="loading..." title="loading..." />
          </div>
        </div>
      </div>
    </div>

    <h1 class="mts mbxs story_title {{story_type}}-icon-title">{{name}}</h1>
    <div class="mbm">
        <div><span class="pale">Requested by:</span> {{requested_by.person.name}}</div>
        <div><span class="pale">Owned by:</span> {{owned_by.person.name}}</div>
        {{#deadline}}
          <div><span class="pale">Deadline:</span> {{deadline}}</div>
        {{/deadline}}
    </div>

    <h2 class="mbs">Description</h2>
    <div class="story_description prs" data-description="{{description}}">{{description}}</div>
    {{#labels_html}}
      <div class="mtm tags-box mrs"><span class="tags">Labels:</span> {{& text}} </div>
    {{/labels_html}}
    <!-- tasks -->
    <h2 class="mbs mtm">
      Tasks 
      <span class="unit-right filter">
        <a href="#" class="filter_all_tasks filter_tasks active">all</a>
        <a href="#" class="filter_completed_tasks filter_tasks">completed</a>
        <a href="#" class="filter_uncompleted_tasks filter_tasks">uncompleted</a>
      </span>
    </h2>
    {{#has_tasks}}
      <ul class="list mbm mrs tasks tasks_list">
        {{#tasks}}
          <li class="pvs task_block {{#complete}}completed{{/complete}}{{^complete}}uncompleted{{/complete}}">
            <div class="main">
              <div class="outer block">
                <span class="unit">
                  <span class="sort_task"></span>
                  <input id="taskCheckbox{{id}}" class="task_checkbox" type="checkbox" data-task-id="{{id}}" data-story-id="{{story_id}}" data-project-id="{{project_id}}" {{#complete}}checked="checked"{{/complete}} /> 
                </span>
                <span class="unit-right mls">
                  <a href="#" class="edit_task_link edit-link">Edit</a>
                  <a href="#" class="delete_task_link del-link">Delete</a>
                </span>
                <span class="mll block"><label for="taskCheckbox{{id}}" class="task_description">{{description}}</label></span>
              </div>
            </div>
            <div class="edit">
              <input class="edit_task_text mbs" autocomplete="off" type="text" value="{{description}}" />
              <input class="edit_task_button button success tiny" type="button" value="Edit" /><span class="mhs h4">or</span><a class="cancel_task_link h4" href="#">Cancel</a>
            </div>
            <div class="loader">
              <img src="images/spinner3.gif" alt="loading..." title="loading..." />
            </div>
          </li>
        {{/tasks}}
      </ul>
    {{/has_tasks}}
    <div class="add_task_block action_block {{#opened_task_box}}adding{{/opened_task_box}}" data-story-id="{{id}}" data-project-id="{{project_id}}">
      <div class="main">
        <a class="open_add_block button primary tiny" href="#">Add task</a>
      </div>
      <div class="add">
        <input class="add_task_text mbs" autocomplete="off" type="text" />
        <input class="add_task_button button success tiny" type="button" value="Add" /><span class="mhs h4">or</span><a class="close_add_block h4" href="#">Cancel</a>
      </div>
      <div class="loader">
        <img src="images/spinner3.gif" alt="loading..." title="loading..." />
      </div>
    </div>
    {{#has_attachments}}
      <h2 class="mbs mtm">Attachments</h2>
      <ul class="mbm list attachments mrs">
        {{#attachments}}
          <li class="pvs">
              <span class="unit attach-icon"></span>
              <div class="mll">
                <strong>{{uploaded_by.person.name}} </strong>
                <div class="neutral"><a href="{{url}}" target="_blank">{{filename}}</a></div>
                <!-- <div class="clippy-box">
                  <div id="attachment_{{id}}" class="attachment_clippy" data-attachment-url="{{url}}"></div>
                </div> -->
              </div>
          </li>
        {{/attachments}}
      </ul>
    {{/has_attachments}}
    <h2 class="mbs mtm">Comments</h2>
    {{#has_comments}}
      <ul class="pbm list mrs comments comments_list" data-story-id="{{id}}" data-project-id="{{project_id}}">
        {{#comments}}
          <li class="pvs comment_block action_block">
            <div class="main fine_delete outer">
              <div class="unit size4of5">
                <strong>{{author.person.name}} </strong>
                <div class="neutral comment_description">{{text}}</div>
              </div>
              <div class="unit size1of5">
                {{#is_owner}}
                  <div class="fine_delete_main unit-right">
                    <a class="fine_delete_link negative del-link" href="#">Delete</a>
                  </div>
                  <div class="fine_delete_confirm txt-right">
                    <div class="mbs">Really?</div> 
                    <a class="delete_comment_link button danger tiny mrs" href="#" data-id="{{id}}">Yes</a>
                    <a class="fine_delete_cancel" href="#">No</a>
                  </div>
                {{/is_owner}}
              </div>
            </div>
            <div class="loader">
              <img src="images/spinner3.gif" alt="loading..." title="loading..." />
            </div>
          </li>
        {{/comments}}
      </ul>
    {{/has_comments}}
    <div class="add_comment_block action_block {{#opened_comment_box}}adding{{/opened_comment_box}}" data-story-id="{{id}}" data-project-id="{{project_id}}">
      <div class="main">
        <a class="open_add_block button primary tiny" href="#">Add comment</a>
      </div>
      <div class="add">
        <textarea class="add_comment_text mbxs" autocomplete="off"></textarea>
        <input class="add_comment_button button success tiny" type="button" value="Add" /><span class="mhs h4">or</span><a class="close_add_block h4" href="#">Cancel</a>
      </div>
      <div class="loader">
        <img src="images/spinner3.gif" alt="loading..." title="loading..." />
      </div>
    </div>
  </script>

  <script id="add_story_template" type="text/x-mustache-template">
    <div class="add_story_box">
      <div class="main form">
      <strong class="errors_box error-text negative"></strong>
        <h1 class="mbm">Add New Story</h1>
        <div class="mbs">
          <label>Project:</label>
          <select class="add_story_project_id chosen_selector">
          {{#projects}}
            <option value="{{id}}">{{name}}</option>
          {{/projects}}
          </select>
        </div>
        <div class="mbs">
          <label>Title:</label>
          <input class="add_story_name" type="text" />
        </div>
        <div class="outer mbs">
          <div class="unit size1of2">
            <div class="prs">
              <label>Story type:</label>
              <select class="add_story_story_type chosen_selector">
                <option value="feature">Feature</option>
                <option value="bug">Bug</option>
                <option value="chore">Chore</option>
                <option value="release">Release</option>
              </select>
            </div>
          </div>
          <div class="unit size1of2">
            <div class="add_story_point_box pls">
              <label>Story points:</label>
              <select class="add_story_point chosen_selector"></select>
            </div>
            <div class="add_story_release_date_box pls">
              <label>Release Date:</label>
              <input readonly="readonly" class="add_story_release_date" type="text" />
            </div>
          </div>
        </div>

        <div class="outer mbs">
          <div class="unit size1of2">
            <div class="prs">
              <label>Requester:</label>
              <select class="add_story_requester_id chosen_selector"></select>
            </div>
          </div>
          <div class="unit size1of2">
            <div class="pls">
              <label>Owner: <a class="add_story_set_owner_on_me" href="#">to me</a></label>
              <select data-placeholder="Select owner" class="add_story_owner_id chosen_selector">
                <option></option>
              </select>
            </div>
          </div>
        </div>
        <div class="mbs">
          <label>Description:</label>
          <textarea class="add_story_description"></textarea>
        </div>
        <div class="mbm">
          <label>Labels: (<span class="h4 pale">type labels separated by comma</span>)</label>
          <input class="add_story_labels" type="text" />
        </div>
        <div class="mbs">
          <input class="add_story_button button success" type="button" value="Add" />
          <span class="mhs">or</span>
          <a class="add_story_close" href="#">Cancel</a>
        </div>
      </div>
      <div class="add_story_result loader">
        <img src="images/spinner3.gif" alt="Loading..." />
      </div>
    </div>
  </script>

  <script id="add_story_result_template" type="text/x-mustache-template">
    <div class="h1 mbm"><span class="done">Story successfully added</span></div>
    <div class="mbs mhl"><strong>{{name}}</strong></div>
    <div><a href="{{url}}" target="_blank">{{url}}</a></div>
    <div class="ptm">
      <a class="add_more_stories button primary" href="#">Add one more story</a><span class="mhs">or</span><a class="add_story_close" href="#">Close</a>
    </div>
  </script>

  <!-- vendors scripts -->
  <script src="javascripts/vendors/jquery-1.7.1.min.js" type="text/javascript"></script>
  <script src="javascripts/vendors/jquery-ui-1.8.16.custom.min.js" type="text/javascript"></script>
  <script src="javascripts/vendors/jquery.jeditable.min.js" type="text/javascript"></script>
  <script src="javascripts/vendors/chosen.jquery.min.js" type="text/javascript"></script>
  <script src="javascripts/vendors/hogan-1.0.3.min.js" type="text/javascript"></script>
  <!-- swf only on popup -->
  <script src="javascripts/vendors/swfobject/swfobject.js" type="text/javascript"></script>
  <!-- main scripts -->
  <script src="javascripts/xml2json.js" type="text/javascript"></script>
  <script src="javascripts/pivotal_rocket_storage.js" type="text/javascript"></script>
  <script src="javascripts/pivotal_api_lib.js" type="text/javascript"></script>
  <script src="javascripts/pivotal_rocket_popup.js" type="text/javascript"></script>

</body>
</html>
